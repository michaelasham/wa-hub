# wa-hub environment variables (copy to .env and fill in)
# Full list of options: see src/config.js and src/observability/sentry.js

# Server
PORT=3000

# Authentication (required for all endpoints except /health)
API_KEY=

# Webhook
WEBHOOK_SECRET=
WEBHOOK_PROTECTION_BYPASS=
WEBHOOK_AUTH_TOKEN=

# Session / auth storage
SESSION_DATA_PATH=./.wwebjs_auth
AUTH_BASE_DIR=./.wwebjs_auth
INSTANCES_DATA_PATH=./.wwebjs_instances.json

# Chromium (hardened launch args applied by default; see README)
CHROME_PATH=/usr/bin/chromium-browser
# Sandbox/zygote: --no-zygote requires --no-sandbox (Chromium enforces this). On Linux both default to 1 to avoid launch failures.
# CHROME_DISABLE_SANDBOX=1  (default 1 on Linux, 0 elsewhere)
# CHROME_USE_NO_ZYGOTE=1    (default 1 on Linux, 0 elsewhere; only has effect when CHROME_DISABLE_SANDBOX=1)
CHROME_ARGS_EXTRA=
WAHUB_LOG_CHROME_ARGS=0
# Override Chromium executable (optional). If set, used first; else google-chrome-stable -> chromium -> bundled (avoids Snap).
# PUPPETEER_EXECUTABLE_PATH=/usr/bin/google-chrome-stable
# Launch diagnostics: 1 = pipe Chromium stderr to process (see PM2 logs); 1 = log executable, memory, shm, /tmp
PUPPETEER_DUMPIO=0
PUPPETEER_DEBUG_LAUNCH=0
CHROME_LAUNCH_TIMEOUT_MS=60000
# Optional: directory for Chromium log files on launch failure (last ~3.5k chars attached to instance.lastError)
# CHROME_LOG_DIR=/tmp

# Optional: instance identification for Sentry (overrides GCP metadata when set)
WA_HUB_INSTANCE_ID=
WA_HUB_INSTANCE_NAME=

# Sentry (leave SENTRY_DSN empty to disable)
# Example: https://KEY@o4510933991030784.ingest.us.sentry.io/PROJECT_ID
SENTRY_DSN=
SENTRY_ENVIRONMENT=production
SENTRY_TRACES_SAMPLE_RATE=0.05
SENTRY_PROFILES_SAMPLE_RATE=0
SENTRY_RELEASE=

# Optional: require X-Admin-Debug-Secret header for GET /system/status (dashboard uses this for Low Power Mode status)
ADMIN_DEBUG_SECRET=

# Logging
LOG_LEVEL=info

# Node (NODE_ENV=production disables /internal/test-sentry and affects error messages)
# NODE_ENV=

# Idempotency store path
IDEMPOTENCY_DATA_PATH=./.wwebjs_idempotency.json

# Instance lifecycle (optional overrides; see src/config.js for full list)
# READY_WATCHDOG_MS=600000
# DISABLE_AUTO_RECONNECT=false
# DELETE_DESTROY_TIMEOUT_MS=15000
# VIEW_SESSION_JWT_SECRET=

# Low-power mode (during QR/auth/sync)
MAX_OUTBOUND_QUEUE=200
OUTBOUND_QUEUE_TTL_MS=300000
OUTBOUND_DRAIN_DELAY_MS=350
INBOUND_FLUSH_BATCH=50
INBOUND_FLUSH_INTERVAL_MS=500
INBOUND_MAX_BUFFER=2000
SYNC_LITE_BLOCK_IMAGES=0
SYNC_LITE_BLOCK_MEDIA=0
SYNC_LITE_BLOCK_FONTS=0
SYNC_LITE_BLOCK_STYLES=0

# Sequential restore (prevent stampede on small VMs)
RESTORE_CONCURRENCY=1
RESTORE_COOLDOWN_MS=30000
RESTORE_MIN_FREE_MEM_MB=800
RESTORE_MAX_ATTEMPTS=5
RESTORE_BACKOFF_BASE_MS=15000

# NEEDS_QR timeout & recovery (prevent global SYNCING held by stuck QR)
QR_SYNC_GRACE_MS=30000
QR_STALE_MS=90000
QR_TTL_MS=300000
QR_MAX_RECOVERY_ATTEMPTS=3
QR_RECOVERY_WATCHDOG_INTERVAL_MS=10000
QR_RECOVERY_BACKOFF_MS=10000,30000,60000
